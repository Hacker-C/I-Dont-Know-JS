# 12. if-else ä»£ç ä¼˜åŒ–æ–¹æ¡ˆ

é«˜çº§è¯­è¨€çš„ä»£ç æ˜¯ç»™äººçœ‹çš„ï¼Œå†™å‡ºä¼˜é›…çš„ä»£ç ä¸ä»…è®©æˆ‘ä»¬è‡ªå·±èµå¿ƒæ‚¦ç›®ï¼Œä¹Ÿè®©åŒè¡Œå¯¹æˆ‘ä»¬åˆ®ç›®ç›¸çœ‹ã€‚æœªæ¥æˆ‘ä»¬è‡ªå·±æˆ–è€…å…¶ä»–äººæ¥ç»´æŠ¤é¡¹ç›®çš„æ—¶å€™ä¹Ÿèƒ½æ–¹ä¾¿è®¸å¤šï¼Œé¿å…â€œå¼€å‘ä¸€æ—¶çˆ½ï¼Œç»´æŠ¤ç«è‘¬åœºâ€ã€‚

ä¼˜é›…ï¼Œæ°¸ä¸è¿‡æ—¶ã€‚è¿™é‡Œç»™å‡º 7 ä¸ªä¼˜åŒ– if-else/switch çš„æ–¹æ¡ˆã€‚

## 1. ä¸‰å…ƒè¡¨è¾¾å¼

ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼å¯ä»¥ä»£æ›¿ç®€å•çš„ if-else è¯­å¥ï¼Œä¸è¿‡ä¸å»ºè®®å†™åµŒå¥—ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œæœ€å¥½ä¸è¦è¶…è¿‡ä¸¤å±‚ã€‚æŸäº›ç‰¹æ®Šæƒ…å†µå¯èƒ½éœ€è¦æ›´å¤šå±‚ï¼Œæ¯”å¦‚ TS ç±»å‹ä½“æ“çš„æ¡ä»¶ç±»å‹çš„æ—¶å€™ã€‚

ä¾‹ 1.1 
```js
// Bad ğŸ˜¢
let temp = ''
if (condition) {
  temp = 'foo'
} else {
  temp = 'bar'
}
```

ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼ä¼˜åŒ–ï¼š
```js
// Good ğŸ˜„
let temp = condition ? 'foo' : 'bar'
```

ä¾‹ 1.2
```js
// Bad ğŸ˜¢
if (count < 10) {
  if (weight < 5) {
    price = 30
  } else {
    price = 35
  }
} else {
  if (weight < 10) {
    price = 20
  } else {
    price = 25
  }
}
```

å°‘æ•°æƒ…å†µä¸‹è¦å†™åµŒå¥—ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œä¾‹å¦‚ vue çš„æ’å€¼è¯­æ³• `{{}}` é‡Œæˆ–è€… `v-bind` ç»‘å®šçš„å˜é‡é‡Œï¼ˆå®é™…ä¸Šå¯ä»¥å†™ `computed` ç­‰ä¼˜åŒ–ï¼‰ï¼Œåˆæˆ–è€…æ˜¯ TS ç±»å‹ä½“æ“çš„æ¡ä»¶ç±»å‹çš„æ—¶å€™å¿…é¡»å†™ï¼Œé‚£æ¨èä¸‹é¢è¿™ç§æ ¼å¼çš„å†™æ³•ï¼Œå¯è¯»æ€§ä¸æ¯” `if-else` å·®ï¼ˆbushiï¼‰ï¼š
```js
// Good ğŸ˜„
// é˜¶æ¢¯å‹ä½“ç°å‡ºåˆ¤æ–­å±‚çº§
price = (
  count < 10
    ? weight < 5 ? 30 : 35
    : weight < 10 ? 20 : 25
)
```

## 2. åˆå¹¶æ¡ä»¶è¡¨è¾¾å¼

ä¾‹ 3.1
```js
// Bad ğŸ˜¢
if (condition1) {
  if (condition2) {
    doSomething()
  }
}
```
åˆå¹¶åµŒå¥—æ¡ä»¶è¯­å¥ï¼š
```js
// Good ğŸ˜„
if (condition1 && condition2) {
    doSomething()
}
```

ä¾‹ 3.2
```js
// Bad ğŸ˜¢
if (condition1) {
  doSomething()
}
if (condition2) {
  doSomething()
}
```
åˆå¹¶ç›¸åŒæƒ…å†µæ¡ä»¶è¯­å¥ï¼š
```js
// Good ğŸ˜„
if (condition1 || condition2) {
    doSomething()
}
```

## 3. æå‰ returnï¼Œå‡å°‘åµŒå¥—

åœ¨å‡½æ•°å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨ `return` ç»ˆæ­¢å‡½æ•°ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ return æ¥å‡å°‘ elseï¼Œä»è€Œç®€åŒ–ä»£ç ã€‚

ä¾‹ 3.1
```js
// Bad ğŸ˜¢
function price(count) {
  let price = 0
  if (count < 10) {
    price = 15
  } else if (count < 20) {
    price = 18
  } else {
    price = 20
  }
  return res
}
```

```js
// Good ğŸ˜„
function price(count) {
  if (count < 10) return 15
  if (count < 20) return 18
  return 20
}
```

ä¾‹ 3.2 æ±‚ä¸‰æ•°ä¸­çš„æœ€å¤§å€¼
```js
// Bad ğŸ˜¢
function max(x, y, z) {
  let res = -Infinity
  if (x > y) {
    if (x > z) res = x
    else res = z
  } else {
    if (y > z) res = y
    else res = z
  }
  return res
}
```

é€šè¿‡æå‰ `return` å’Œåˆå¹¶æ¡ä»¶è¡¨è¾¾å¼ï¼Œä»£ç å˜å¾—ç®€æ´è®¸å¤šï¼š
```js
// Good ğŸ˜„
function max(x, y, z) {
  if (x > y && x > z) return x
  if (y > x && y > z) return y
  return z
}
```

## 4. ä¸»å¹²ä»£ç ç½®åï¼Œèµ°æ­£å¸¸æµç¨‹

æå‰åˆ¤æ–­ä¸æ»¡è¶³æ¡ä»¶çš„æƒ…å†µï¼Œç„¶å `return` æˆ–è€… `throw` é€€å‡ºï¼Œä¸»å¹²ä»£ç ï¼ˆæ­£å¸¸æƒ…å†µï¼‰æ”¾åˆ°åé¢ï¼Œèµ°æ­£å¸¸æµç¨‹ã€‚

ä¾‹ 4.1
```js
// Bad ğŸ˜¢
function getApples(total, count) {
  if (total > 0) {
    if (count > 0) {
      if (total >= count) {
        console.log('æˆåŠŸæ‹¿åˆ°è‹¹æœ')
        total -= count
      } else {
        console.log('è‹¹æœä¸è¶³')
      }
    } else {
      console.log('ä¸èƒ½å– 0 ä¸ª')
    }
  } else {
    console.log('æ²¡æœ‰è‹¹æœäº†')
  }
}
```

å…ˆè®©å¼‚å¸¸æƒ…å†µé€€å‡ºï¼Œå°†ä¸»å¹²ä»£ç ç½®åï¼Œç¨‹åºé€»è¾‘æ¸…æ™°è®¸å¤šã€‚
```js
// Good ğŸ˜„
function getApples(total, count) {
  // å…ˆåˆ¤æ–­å¼‚å¸¸æƒ…å†µ
  if (total <= 0) {
    return console.log('æ²¡æœ‰è‹¹æœäº†')
  }
  if (count <= 0) {
    return console.log('ä¸èƒ½å– 0 ä¸ª')
  }
  if (total < count) {
    return console.log('è‹¹æœä¸è¶³')
  }
  // ä¸»å¹²ä»£ç 
  total -= count
  console.log('æˆåŠŸæ‹¿åˆ°è‹¹æœ')
}
```

## 5. è¡¨é©±åŠ¨

è¡¨é©±åŠ¨ï¼ˆTable-Driven Methodsï¼‰æ˜¯åœ¨ä¸€ä¸ªä¿¡æ¯è¡¨ä¸­æ ¹æ®æ¡ä»¶æŸ¥æ‰¾ç›®æ ‡å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ `if-else/switch` ç­‰é€»è¾‘è¯­å¥æ¥æŸ¥æ‰¾ã€‚è¿™ä¸ªè¡¨æ˜¯ä¸€ä¸ª **ä»æ¡ä»¶è¾“å…¥åˆ°ç»“æœè¾“å‡ºçš„æ˜ å°„å…³ç³»**ï¼š

```js
condition -> table -> result
```

- `condition`ï¼šæ¡ä»¶è¾“å…¥
- `table`ï¼šæ˜ å°„è¡¨
- `result`ï¼šç»“æœè¾“å‡º

:::warning
è¡¨é©±åŠ¨é€‚ç”¨äº switch è¯­å¥å’Œæœ‰é™ä¸ªæ¡ä»¶çš„ç¦»æ•£å‹ if-else è¯­å¥çš„ä¼˜åŒ–ã€‚æ‰€è°“ç¦»æ•£å‹ if-else å°±æ˜¯æŒ‡å…¶æƒ…å†µéƒ½èƒ½åˆ—å‡ºæ¥ï¼Œä½†æœ‰äº›è¿ç»­å‹çš„å…¶å®èƒ½å¤Ÿè½¬æ¢ä¸ºç¦»æ•£å‹ï¼Œå…·ä½“è§ä¸‹ä¸€èŠ‚ã€‚
:::

è¡¨é©±åŠ¨çš„å…³é”®å°±æ˜¯å»ºç«‹è¿™ä¸ª `table`ï¼Œåœ¨ JS ä¸­ï¼Œä½¿ç”¨ `plain object` æˆ–è€… `Map` ç±»å‹éƒ½èƒ½åˆ›å»ºä¸€ä¸ªæ˜ å°„è¡¨ã€‚

ä¾‹ 5.1
```js
// Bad ğŸ˜¢
const rainbowColor = n => {
  if (n === 1) return 'red'
  if (n === 2) return 'orange'
  if (n === 3) return 'yellow'
  if (n === 4) return 'green'
  if (n === 5) return 'blue'
  if (n === 6) return 'indigo'
  if (n === 7) return 'violet'
}
```

çœ‹åˆ°è¿™ä¹ˆå¤š `if` ç¡®å®æœ‰ç‚¹éº»ï¼Œå†™äº†å¾ˆå¤šé‡å¤çš„ä»£ç ï¼Œå…ˆä½¿ç”¨ `switch-case` ä¼˜åŒ–ï¼š
```js
// Bad ğŸ˜¢
const rainbowColor = n => {
  switch (n) {
    case 1:
      return 'red'
    case 2:
      return 'orange'
    case 3:
      return 'yellow'
    case 4:
      return 'green'
    case 5:
      return 'blue'
    case 6:
      return 'indigo'
    case 7:
      return 'violet'
  }
}
```

å¹¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œå†—ä½™ä»£ç æ›´å¤šäº†ï¼Œä½¿ç”¨è¡¨é©±åŠ¨æ–¹æ³•ä¼˜åŒ–å¦‚ä¸‹ï¼Œè¿™ä¸‹èµå¿ƒæ‚¦ç›®å¤šäº†ï¼
```js
// Good ğŸ˜„
const rainbowColor = n => {
  const obj = {
    1: 'red',
    2: 'orange',
    3: 'yellow',
    4: 'green',
    5: 'blue',
    6: 'indigo',
    7: 'violet'
  }
  return obj?.[n] ?? 'not found'
}
```

æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨ `Map` å»ºç«‹â€œè¡¨â€ï¼š
```js
// Good ğŸ˜„
const rainbowColor = n => {
  const map = new Map()
    .set(1, 'red')
    .set(2, 'orange')
    .set(3, 'yellow')
    .set(4, 'green')
    .set(5, 'blue')
    .set(6, 'indigo')
    .set(7, 'violet')
  return map?.get(n) ?? 'not found'
}
```

ä¾‹ 5.2 æ›´å¤šæ—¶å€™ï¼Œå¯èƒ½éƒ½æ˜¯ä¸‹é¢è¿™ç§æƒ…å†µ
```js
// Bad ğŸ˜¢
if (condition1) {
  doSomething(param1)
} else if (condition2) {
  doSomething(param2)
} else if (condition3) {
  doSomething(param3)
} else {
  doSomething(param4)
}
```

ä½¿ç”¨ `switch` æ”¹é€ å¦‚ä¸‹ï¼Œä¼¼ä¹å¥½äº†ä¸€ç‚¹ï¼Œä»£ç è¿˜æ˜¯å†—ä½™ã€‚
```js
switch (condition) {
  case condition1:
    return void doSomething(param1)
  case condition2:
    return void doSomething(param2)
  case condition3:
    return void doSomething(param3)
  default:
    return void doSomething(param4)
}
``` 
:::tip æ³¨æ„
`return void` ä¿è¯æ— è¿”å›å€¼ï¼Œæˆ–è€…è¯´è¿”å› `undefined`ï¼Œé˜²æ­¢é€ æˆæŸäº›ä¸å¯é¢„æœŸçš„å½±å“ã€‚
:::

è¡¨é©±åŠ¨æ”¹é€ ï¼š
```js
// Good ğŸ˜„
const run = condition => {
  const map = new Map()
    .set(condition1, param1)
    .set(condition2, param2)
    .set(condition3, param3)
  return void doSomething(map?.get(condition) ?? param4)
}

run(condition)
```

## 6. ç¦»æ•£åŒ–

é€šè¿‡ä¹‹å‰çš„è®²è§£ï¼Œè¡¨é©±åŠ¨é€‚åˆç”¨æ¥ä¼˜åŒ– `switch` è¯­å¥å’Œæƒ…å†µè¾ƒå°‘å’Œæœ‰é™çš„ `if-else` æ¡ä»¶è¯­å¥ï¼Œå¯¹äºä¸‹é¢è¿™ç§æƒ…å†µæ¯”è¾ƒå¤šæˆ–è€…æ— é™æƒ…å†µçš„ï¼ˆè¿ç»­å‹ï¼‰ï¼Œéœ€è¦å…ˆå°†å…¶ç¦»æ•£åŒ–ã€‚

ä¾‹ 6.1 æˆç»©è¯„çº§ï¼ˆä¿è¯è¾“å…¥æ•°æ®åœ¨ 0-100ï¼‰
```js
// Bad ğŸ˜¢
function scoreLevel(score) {
  if (score >= 90) {
    return 'A'
  } else if (score >= 80) {
    return 'B'
  } else if (score >= 70) {s
    return 'C'
  } else if (score >= 60) {
    return 'D'
  } else {
    return 'D-'
  }
}
```

å¯¹äºæƒ…å†µæ¯”è¾ƒå¤šï¼ˆç”šè‡³æ— é™å¤šï¼‰çš„æƒ…å†µï¼Œç›´æ¥ä½¿ç”¨è¡¨é©±åŠ¨æœ‰ç‚¹å¤æ‚ç”šè‡³å®ç°ä¸äº†ã€‚è¿™é‡Œéœ€è¦å°†è¿ç»­å‹çš„æ•°æ®è½¬æ¢ä¸ºç¦»æ•£å‹çš„æ•°æ®ï¼Œå³ **å°† score/10 ç„¶åå‘ä¸‹å–æ•´ï¼Œè¿™æ ·æ¯ä¸ªæƒ…å†µçš„èŒƒå›´éƒ½ç¼©å°äº†**ï¼Œæ¯”å¦‚ `[60, 75)` çš„è®¡ç®—ç»“æœåªæœ‰ `6`ã€‚
```js
// Good ğŸ˜„
function scoreLevel(score) {
  const h = Math.floor(score / 10)
  const map = new Map()
    .set(10, 'A')
    .set(9, 'A')
    .set(8, 'B')
    .set(7, 'C')
    .set(6, 'D')
  return map?.get(h) ?? 'D-'
}
```

æ€ä¹ˆæ ·ï¼Œä»£ç æ˜¯ä¸æ˜¯ä¼˜é›…ç®€æ´å¤šäº†ã€‚

## 7. includes / indexOf

`includes` å’Œ `indexOf` éƒ½æ˜¯æ•°ç»„æ–¹æ³•ï¼Œå‰è€…ç”¨äºæŸ¥æ‰¾æŸä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå…ƒç´ ï¼Œåè€…æ˜¯è·å–æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªç›®æ ‡å…ƒç´ çš„ä¸‹æ ‡ã€‚

ä¾‹ 7.1
```js
// Bad ğŸ˜¢
if (fruit === 'apple' || fruit === 'strawberry' || fruit === 'cherry') {
  // è‹¹æœã€è‰è“å’Œæ¨±æ¡ƒéƒ½æ˜¯çº¢è‰²çš„
  console.log('red')
}
```

ä½¿ç”¨ `includes` ä¼˜åŒ–ï¼š
```js
// Good ğŸ˜„
if (['apple', 'strawberry', 'cherry'].includes(fruit)) {
  // è‹¹æœã€è‰è“å’Œæ¨±æ¡ƒéƒ½æ˜¯çº¢è‰²çš„
  console.log('red')
}
```

ä½¿ç”¨ `indexOf` ä¼˜åŒ–ï¼š
```js
// Good ğŸ˜„
if (['apple', 'strawberry', 'cherry'].indexOf(fruit) !== -1) {
  // è‹¹æœã€è‰è“å’Œæ¨±æ¡ƒéƒ½æ˜¯çº¢è‰²çš„
  console.log('red')
}
```

## 8. ä½¿ç”¨å‡½æ•°é»˜è®¤å‚æ•°å’Œ ??

ä¼˜åŒ–å‰ï¼š
```js
// Bad ğŸ˜¢
function getStatusMessage(status, errorCode) {
  if (!status) return 'NA'
  if (errorCode) {
    return `Status:${status}, err:{errorCode}`
  } else {
    return `Status:${status}, err: -1`
  }
}
```
ä¼˜åŒ–ä¹‹åï¼š
```js
// Good ğŸ˜„
function getStatusMessage(status = 'NA', errorCode) {
  return `Status:${status}, err:${errorCode ?? -1}`
}
```